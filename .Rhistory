colMeans(cbind(RESULTS), na.rm=TRUE)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/trend_none_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/trend_const_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/trend_const_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/trend_trend_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Downloads/ML-2/Sim_R1000_n100_d0.75_nu1_ar_high.RData")
load("~/Downloads/ML-2/Sim_R1000_n100_d0.75_nu1_ar_high.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS
load("~/Downloads/ML-2/Sim_R1000_n100_d0.75_nu1_ar_high.RData")
RESULTS <- t(RESULTS)
head(RESULTS)
load("~/Downloads/ML-2/Sim_R1000_n100_d0.75_nu1_ar_high_corr.RData")
RESULTS
RESULTS <- t(RESULTS)
RESULTS
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
load("~/Downloads/ML-2/Sim_R1000_n100_d1_nu1_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], 0.5)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu1_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n100_d1.75_nu1_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n100_d1.75_nu5_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n100_d1.75_nu10_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n200_d1.75_nu10_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n300_d1.75_nu10_ar_high_corr.RData")
load("~/Downloads/ML-2/Sim_R1000_n300_d1.75_nu5_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
#
load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_none_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_const_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_trend_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/const_none_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/const_const_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/const_trend_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/trend_none_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
#
load("~/Downloads/ML-2/Sim_R1000_n200_d1.25_nu10_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
View(RESULTS)
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
15.4*12
48293 - 46963
1330/11
121*12
1631*0.2077
1631*0.2077 + 184.8
1631*0.3137 + 184.8
1631*0.3137
696.44-538.94
538.94/12
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_none_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
View(RESULTS)
lm(RESULTS[,2] ~ RESULTS[,8])
lm(RESULTS[,2] ~ RESULTS[,8]) %>% summary
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_none_p2_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
RESULTS
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_none_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
old <- RESULTS
48*12
XX <- rnorm(1000)
XX <- cbind(rnorm(1000), rnorm(1000))
y <- XX %*% c(1, 2)
solve(t(XX)%*%XX)
chol2inv(chol(XX))
chol2inv(chol(t(XX)%*%XX))
?lm.fit
lm.fit
C_Cdqrls
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d1_nu1_ar_high_ML.RData")
View(RESULTS)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n300_d1.75_nu10_ar_high_corr.RData")
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d0.75_nu1_ar_high_ML.RData")
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d0.75_nu1_ar_high_corr.RData")
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d1.25_nu1_ar_high_corr.RData")
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d0.75_nu1_ar_high_corr copy.RData")
RESULTS2 <- RESULTS
rowMeans(RESULTS2)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d0.75_nu1_ar_high_corr.RData")
rowMeans(RESULTS)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d0.75_nu1_ar_high_corr.RData")
rowMeans(RESULTS)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d1_nu1_ar_high_corr.RData")
rowMeans(RESULTS)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d1.25_nu1_ar_high_corr.RData")
rowMeans(RESULTS)
library(dplyr)
# aus eviews gruppe "alle_prognosen" -> markieren und copy (Strg + C)
dat <- read.table("clipboard", header = FALSE) %>% setNames(c("Date", "Anzeigen Konj-KUG saisonbereinigt","Konj-KUG saisonbereinigt", "Konjunktur-KUG", "Transfer-KUG",	"Saison-KUG",	"Zusammen"))
dat
load("~/Dokumente/Projekte/unit_roots/R/1_RESULTS_new.RData")
View(RESULTS)
3699 + 196 + 135 + 62 + 32
84.7+110.39+115.64
gc()
rm(list = ls())
library(fUCpack)
library(dplyr)
# Wd, etc
setwd("/Users/tobias/Dokumente/Projekte/Filtering unknown persistence/R/code")
source("./help functions/KF.R")
# Settings
n <- c(100, 200, 300)
d <- c(0.75, 1, 1.75)
ratio <- c(1, 10, 30, 0)
R <- 1000
ar <- c(-1.6, 0.8)
# Long-run variance part
cvar <- function(ar){
p <- length(ar)
A <- toComp(-ar)$CompMat
return(matrix(solve(diag(p^2)-(A%x%A))%*%c(1,rep(0,p^2-1)),p,p)[1,1])
}
xvar <- function(n, d){
pisq <- frac_diff(c(1, rep(0, n-1)), -d)^2
var  <- cumsum(pisq)
return(mean(var))
}
setups <- expand.grid(n, d, ratio)
# calculate variance ratio for grid
colnames(setups) <- c("n", "d", "ratio")
setups <- setups[order(setups[, "n"]), ]
# calculate the true nu:
nucalc <- function(n, d, ratio, ar){
if(ratio == 0) return(1)
var_x <- xvar(n, d)
var_c <- cvar(ar)
nu    <- var_x/var_c * (1 / ratio)
return(nu)
}
# get nu
nuc <- sapply(1:nrow(setups), function(x) nucalc(setups[x, 1], setups[x, 2], setups[x, 3], ar))
results.list <- list()
X.res <- list()
C.res <- list()
X.true <- list()
C.true <- list()
i=1
true.par          <- setups[i, ]
setup <- setups[ i, ]
n <- as.numeric(setup[1])
d <- as.numeric(setup[2])
true.par          <- setups[i, ]
setup <- setups[ i, ]
n <- as.numeric(setup[1])
d <- as.numeric(setup[2])
nu <- nucalc(n, d, setups[i, 3], ar)
r <- setups[i, 3]
# check if simulation has already been done
set.seed(42)
# Generate the data
x <- frac_diff_multi(matrix(rnorm(n*R, mean=0, sd=1), n, R), -d)
u <- matrix(rnorm(n*R, mean=0, sd=sqrt(nu)), n, R)
c <- apply(u, 2, function(x) stats::filter(c(rep(0, length(ar)), x), filter = c(-ar), method = "recursive", sides = 1)[-(1:length(ar))])
y <- yy<-x + c
if(r == 0){
trend <- (1/1) * (1:n)
}else{
trend <- (1/sqrt(r)) * (1:n)
}
y <- y + trend
X.mat <- x
C.mat <- c
X.true[[i]] <- X.mat
C.true[[i]] <- C.mat
load(paste("./MC/MC_3/ML_INTEGER/Sim_R1000_n", true.par[1], "_d", true.par[2], "_r", true.par[3],
"_trend.RData", sep=""))
results.list[[i]] <- RESULTS
filterfun <- function(theta, y){
tryCatch({
det      <- fUC_opt_ML(c(1, log(theta[1]), theta[-1]), y,
nulim = c(0, Inf), nu.opt = TRUE, d.int = c(0, 3),
corr=FALSE, deterministics = "trend", START = 1,
return.det = TRUE)
KS <- fUC_smooth(y - det*(1:n), theta[1], theta[2], theta[-(1:2)], corr=FALSE)
return(c(KS$x, KS$c))
}, error = function(e) return(rep(NA, 2*length(y))))
}
theta
j=1
RESULTS[1:4,j]
XC <- parSapply(cl, 1:R, function(j) filterfun(RESULTS[1:3,j], y[,j]))
library(parallel)
XC <- parSapply(cl, 1:R, function(j) filterfun(RESULTS[1:3,j], y[,j]))
cl <- makeCluster(6)
clusterExport(cl, c("fUC_opt_ML", "y", "fUC_comp", "ma_inf", "true.par", "RESULTS",
"embed0", "fUC_smooth", "x", "frac_diff", "lm", "n", "filterfun"))
clusterEvalQ(cl, library(fUCpack))
XC <- parSapply(cl, 1:R, function(j) filterfun(RESULTS[1:3,j], y[,j]))
stopCluster(cl)
X.mat <- XC[1:n, ]
C.mat <- XC[-(1:n), ]
X.mat
true.par          <- setups[i, ]
setup <- setups[ i, ]
n <- as.numeric(setup[1])
d <- as.numeric(setup[2])
nu <- nucalc(n, d, setups[i, 3], ar)
r <- setups[i, 3]
# check if simulation has already been done
set.seed(42)
# Generate the data
x <- frac_diff_multi(matrix(rnorm(n*R, mean=0, sd=1), n, R), -d)
u <- matrix(rnorm(n*R, mean=0, sd=sqrt(nu)), n, R)
c <- apply(u, 2, function(x) stats::filter(c(rep(0, length(ar)), x), filter = c(-ar), method = "recursive", sides = 1)[-(1:length(ar))])
y <- yy<-x + c
if(r == 0){
trend <- (1/1) * (1:n)
}else{
trend <- (1/sqrt(r)) * (1:n)
}
y <- y + trend
X.mat <- x
C.mat <- c
X.true[[i]] <- X.mat
C.true[[i]] <- C.mat
try({
load(paste("./MC/MC_3/ARMA/Sim_R1000_n", true.par[1], "_d", true.par[2], "_r", true.par[3],
"_corr0_trend.RData", sep=""))
results.list[[i]] <- RESULTS[, colSums(is.na(RESULTS))==0 & RESULTS[1, ] < 1e+06]
filterfun <- function(theta, y){
tryCatch({
KS <- fUC_KS_ARMA_approx(theta,
y=y, START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07),
deterministics = "trend")
#KS <- fUC_smooth(y, theta[1], theta[2], theta[-(1:2)], corr=FALSE)
return(c(KS$x, KS$c))
}, error = function(e) return(rep(NA, 2*length(y))))
}
XC <- sapply(1:R, function(j) filterfun(c(RESULTS[1,j], log(RESULTS[2,j]), RESULTS[3:4, j]), y[,j]))
X.mat <- XC[1:n, ]
C.mat <- XC[-(1:n), ]
})
XC
load(paste("./MC/MC_3/ARMA/Sim_R1000_n", true.par[1], "_d", true.par[2], "_r", true.par[3],
"_corr0_trend.RData", sep=""))
results.list[[i]] <- RESULTS[, colSums(is.na(RESULTS))==0 & RESULTS[1, ] < 1e+06]
filterfun <- function(theta, y){
tryCatch({
KS <- fUC_KS_ARMA_approx(theta,
y=y, START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07),
deterministics = "trend")
#KS <- fUC_smooth(y, theta[1], theta[2], theta[-(1:2)], corr=FALSE)
return(c(KS$x, KS$c))
}, error = function(e) return(rep(NA, 2*length(y))))
}
j=1
filterfun(c(RESULTS[1,j], log(RESULTS[2,j]), RESULTS[3:4, j]), y[,j])
y=y[,1]
theta =c(RESULTS[1,j], log(RESULTS[2,j]), RESULTS[3:4, j])
theta
KS <- fUC_KS_ARMA_approx(theta,
y=y, START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07),
deterministics = "trend")
library(CFFpack)
KS <- fUC_KS_ARMA_approx(theta,
y=y, START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07),
deterministics = "trend")
# ARMA
source("./help functions/fUC_arma_approx.R")
library(CFFpack)
KS <- fUC_KS_ARMA_approx(theta,
y=y, START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07),
deterministics = "trend")
KS
fUC_KS_ARMA_approx
fUC_KF_approx
fUC_opt_ML_ARMA_approx(theta,
y=y, START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07),
deterministics = "trend", return.det = TRUE)
trend <- fUC_opt_ML_ARMA_approx(theta,
y=y, START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07),
deterministics = "trend", return.det = TRUE)
KS <- fUC_KS_ARMA_approx(theta,
y=y - trend*(1:n), START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07))
KS
filterfun <- function(theta, y){
tryCatch({
trend <- fUC_opt_ML_ARMA_approx(theta,
y=y, START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07),
deterministics = "trend", return.det = TRUE)
KS <- fUC_KS_ARMA_approx(theta,
y=y - trend*(1:n), START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07))
#KS <- fUC_smooth(y, theta[1], theta[2], theta[-(1:2)], corr=FALSE)
return(c(KS$x, KS$c))
}, error = function(e) return(rep(NA, 2*length(y))))
}
XC <- sapply(1:R, function(j) filterfun(c(RESULTS[1,j], log(RESULTS[2,j]), RESULTS[3:4, j]), y[,j]))
true.par          <- setups[i, ]
setup <- setups[ i, ]
n <- as.numeric(setup[1])
d <- as.numeric(setup[2])
nu <- nucalc(n, d, setups[i, 3], ar)
r <- setups[i, 3]
# check if simulation has already been done
set.seed(42)
# Generate the data
x <- frac_diff_multi(matrix(rnorm(n*R, mean=0, sd=1), n, R), -d)
u <- matrix(rnorm(n*R, mean=0, sd=sqrt(nu)), n, R)
c <- apply(u, 2, function(x) stats::filter(c(rep(0, length(ar)), x), filter = c(-ar), method = "recursive", sides = 1)[-(1:length(ar))])
y <- yy<-x + c
if(r == 0){
trend <- (1/1) * (1:n)
}else{
trend <- (1/sqrt(r)) * (1:n)
}
y <- y + trend
X.mat <- x
C.mat <- c
X.true[[i]] <- X.mat
C.true[[i]] <- C.mat
try({
load(paste("./MC/MC_3/ARMA/Sim_R1000_n", true.par[1], "_d", true.par[2], "_r", true.par[3],
"_corr0_trend.RData", sep=""))
results.list[[i]] <- RESULTS[, colSums(is.na(RESULTS))==0 & RESULTS[1, ] < 1e+06]
filterfun <- function(theta, y){
tryCatch({
trend <- fUC_opt_ML_ARMA_approx(theta,
y=y, START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07),
deterministics = "trend", return.det = TRUE)
KS <- fUC_KS_ARMA_approx(theta,
y=y - trend*(1:n), START = 2, corr =FALSE, d.int = c(0, 3),
pq=c(2, 0),penalty.corr=FALSE,
nulim = c(1/1000, 1e+07))
#KS <- fUC_smooth(y, theta[1], theta[2], theta[-(1:2)], corr=FALSE)
return(c(KS$x, KS$c))
}, error = function(e) return(rep(NA, 2*length(y))))
}
XC <- sapply(1:R, function(j) filterfun(c(RESULTS[1,j], log(RESULTS[2,j]), RESULTS[3:4, j]), y[,j]))
X.mat <- XC[1:n, ]
C.mat <- XC[-(1:n), ]
})
X.res[[i]] <- X.mat
cl <- makeCluster(cl)
clusterExport(cl, c("fUC_opt_ML_ARMA_approx", "fUC_KS_ARMA_approx", "y", "fUC_comp", "ma_inf", "true.par", "RESULTS",
"embed0", "fUC_smooth", "x", "frac_diff", "lm", "n", "filterfun"))
clusterEvalQ(cl, library(fUCpack))
clusterEvalQ(cl, library(CFFpack))
XC <- parSapply(cl, 1:R, function(j) filterfun(c(RESULTS[1,j], log(RESULTS[2,j]), RESULTS[3:4, j]), y[,j]))
stopCluster(cl)
X.mat <- XC[1:n, ]
X.mat
filterfun(c(RESULTS[1,j], log(RESULTS[2,j]), RESULTS[3:4, j])
, y[,j])
load("/Users/tobias/Dokumente/Projekte/Filtering unknown persistence/R/code/MC/MC_3/CSS/results.RData")
results.list[[32]]
X.res[[32]]
X.res[[1]]
