load("~/Dokumente/Projekte/FTMUCM/R/app/ML_corr/frac_p1_tol_1e-08_BFGS_START_1_mlv_wide.RData")
View(RESULTS)
load("~/Dokumente/Projekte/FTMUCM/R/app/ML_corr/frac_p2_tol_1e-08_BFGS_START_1_mlv_wide.RData")
pd_cov
fUCpack::pd_cov
pd_cov(c( 0.8608321, -0.2403811, 0.05068191), "chol")
library(KFAS)
library(fUCpack)
pd_cov(c( 0.8608321, -0.2403811, 0.05068191), "chol")
pd_cov(c( 0.8608321, -0.2403811, 0.05068191), "chol") %>% cov2cor
library(dplyr)
pd_cov(c( 0.8608321, -0.2403811, 0.05068191), "chol") %>% cov2cor
pd_cov(c( 1.147175, -0.1033672, -0.1455973), "chol") %>% cov2cor
pd_cov(c( 1.147175, -0.1033672, -0.1455973), "chol")
pd_cov(c(-0.1470943 -2.122888 0.5833575), "chol")
pd_cov(c(-0.1470943, -2.122888, 0.5833575), "chol")
pd_cov(c(-0.1470943, -2.122888, 0.5833575), "chol") %>% cov2cor
data.frame1 <- data.frame(
Buchstabe = c("A", "B", "C"),
Zahl = c(1, 2, 3)
)
data.frame2 <- data.frame(
Zahl = c(3, 1, 6),
Buchstabe = c("X", "Y", "Z")
)
rbind(data.frame1, data.frame2)
b <- 1
(1:n)^(0)
(1:100)^(0)
(1:100)^(-0.3)
(1:100)^(1)
(1:100)^(0.9)
?merge
data.frame1 <- data.frame(
Dienststellennummer = c("1", "2", "3"),
Bezugsgroesse = c(6, 3, 4)
)
data.frame2 <- data.frame(
Dienststellennummer = c("3", "1", "2"),
ALO = c(10, 28, 21)
)
merge(data.frame1, data.frame2)
?systemfit
??systemfit
sessionInfo()
ma <- c(1.5, 0.92)
maInvert <- function(ma) {
q <- length(ma)
q0 <- max(which(c(1, ma) != 0)) - 1L
if (!q0)
return(ma)
roots <- polyroot(c(1, ma[1L:q0]))
ind <- Mod(roots) < 1
if (all(!ind)){
return(TRUE)
}else{
return(FALSE)
}
}
maInvert(ma)
q <- length(ma)
q0 <- max(which(c(1, ma) != 0)) - 1L
if (!q0)
return(ma)
roots <- polyroot(c(1, ma[1L:q0]))
roots
Mod(roots)
ARMAtoMA(ar=NULL, ma=ma)
ARMAtoMA(ar=NULL, ma=ma, lag.max=3)
ARMAtoMA(ar=NULL, ma=ma, lag.max=4)
ARMAtoMA(ar=NULL, ma=ma, lag.max=5)
ARMAtoMA(ar=-ma, ma=NULL, lag.max=5)
ARMAtoMA(ar=-ma, ma=NULL, lag.max=20)
ARMAtoMA(ar=-ma, ma=NULL, lag.max=200)
ma <- c(1.29, 1.25, 0.93, 0)
maInvert <- function(ma) {
q <- length(ma)
q0 <- max(which(c(1, ma) != 0)) - 1L
if (!q0)
return(ma)
roots <- polyroot(c(1, ma[1L:q0]))
ind <- Mod(roots) < 1
if (all(!ind)){
return(TRUE)
}else{
return(FALSE)
}
}
maInvert(ma)
ARMAtoMA(ar=-ma, ma=NULL, lag.max=200)
load("~/Downloads/Sim_R1000_n100_d0.75_nu1_ar_high.RData")
View(RESULTS)
rowMeans(RESULTS)
apply(RESULTS, 1, median)
hist(RESULTS[2,])
hist(RESULTS[2,], breaks = 100)
summary(RESULTS[2,])
quantile(RESULTS[2,], .5)
quantile(RESULTS[2,], c(.1, .2, .3, .4, .5, .6, .7, .8, .9))
(RESULTS[2,] - 1)^2 %>% sum
mean((RESULTS[2,] - 1)^2)
RES <- RESULTS
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_2/Sim_R1000_n100_d0.75_nu1_ar_high.RData")
mean((RESULTS[2,] - 1)^2)
(RESULTS[2,] - 1)^2 %>% sum
quantile(RESULTS[2,], c(.1, .2, .3, .4, .5, .6, .7, .8, .9))
6385*1.055
6385*1.055*12
(6385*1.055)/6185
2+2
reticulate::repl_python()
reticulate::repl_python()
2+7
yes
library(fUCpack)
Q=mlogvech2mat(c(-2.782968, 1.763637, 2.977755))
cov2cor(Q)
Q
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/kaggle/const_ML_frac_cor_p1_START_2.RData")
View(RESULTS)
mlogvech2mat(c(-23.52121771,
-10.1268319,
-0.47755681
))
library(fUCpack)
mlogvech2mat(c(-23.52121771,
-10.1268319,
-0.47755681
))
library(dyplr)
library(dplyr)
mlogvech2mat(c(-23.52121771,
-10.1268319,
-0.47755681
)) %>% cov2cor
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/kaggle/none_ML_frac_cor_p1_START_2.RData")
arfima::arfima
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_none_p2_corr.RData")
colMeans(RESULTS, na.rm=TRUE)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
RESULTS
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)])
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_const_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_trend_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/const_none_p2.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/const_const_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/const_trend_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
colMeans(cbind(RESULTS), na.rm=TRUE)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/trend_none_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/trend_const_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/trend_const_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/trend_trend_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
load("~/Downloads/ML-2/Sim_R1000_n100_d0.75_nu1_ar_high.RData")
load("~/Downloads/ML-2/Sim_R1000_n100_d0.75_nu1_ar_high.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS
load("~/Downloads/ML-2/Sim_R1000_n100_d0.75_nu1_ar_high.RData")
RESULTS <- t(RESULTS)
head(RESULTS)
load("~/Downloads/ML-2/Sim_R1000_n100_d0.75_nu1_ar_high_corr.RData")
RESULTS
RESULTS <- t(RESULTS)
RESULTS
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 20)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
load("~/Downloads/ML-2/Sim_R1000_n100_d1_nu1_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], 0.5)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu1_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n100_d1.75_nu1_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n100_d1.75_nu5_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n100_d1.75_nu10_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n200_d1.75_nu10_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Downloads/ML-2/Sim_R1000_n300_d1.75_nu10_ar_high_corr.RData")
load("~/Downloads/ML-2/Sim_R1000_n300_d1.75_nu5_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
#
load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_none_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_const_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_trend_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/const_none_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/const_const_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/const_trend_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/trend_none_p2_corr.RData")
#
#load("~/Downloads/ML-2/Sim_R1000_n100_d1.25_nu10_ar_high_corr.RData")
#RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
#
load("~/Downloads/ML-2/Sim_R1000_n200_d1.25_nu10_ar_high_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
View(RESULTS)
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
15.4*12
48293 - 46963
1330/11
121*12
1631*0.2077
1631*0.2077 + 184.8
1631*0.3137 + 184.8
1631*0.3137
696.44-538.94
538.94/12
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_none_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
View(RESULTS)
lm(RESULTS[,2] ~ RESULTS[,8])
lm(RESULTS[,2] ~ RESULTS[,8]) %>% summary
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_none_p2_corr.RData")
RESULTS <- t(RESULTS)
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
RESULTS
load("~/Dokumente/Projekte/Filtering unknown persistence/R/Applications/pseudo/none_none_p2_corr.RData")
RESULTS <- RESULTS[!is.na(RESULTS[,1]), ]
RESULTS <- cbind(RESULTS, apply(RESULTS[, 3:5], 1, function(x) cov2cor(mlogvech2mat(x))[2,1]))
colMeans(RESULTS)
hist(RESULTS[, ncol(RESULTS)], breaks = 50)
quantile(RESULTS[, ncol(RESULTS)], c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9))
old <- RESULTS
48*12
XX <- rnorm(1000)
XX <- cbind(rnorm(1000), rnorm(1000))
y <- XX %*% c(1, 2)
solve(t(XX)%*%XX)
chol2inv(chol(XX))
chol2inv(chol(t(XX)%*%XX))
?lm.fit
lm.fit
C_Cdqrls
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d1_nu1_ar_high_ML.RData")
View(RESULTS)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n300_d1.75_nu10_ar_high_corr.RData")
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d0.75_nu1_ar_high_ML.RData")
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d0.75_nu1_ar_high_corr.RData")
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d1.25_nu1_ar_high_corr.RData")
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d0.75_nu1_ar_high_corr copy.RData")
RESULTS2 <- RESULTS
rowMeans(RESULTS2)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d0.75_nu1_ar_high_corr.RData")
rowMeans(RESULTS)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d0.75_nu1_ar_high_corr.RData")
rowMeans(RESULTS)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d1_nu1_ar_high_corr.RData")
rowMeans(RESULTS)
load("~/Dokumente/Projekte/Filtering unknown persistence/R/MC/MC_server/Integer/ML/Sim_R1000_n100_d1.25_nu1_ar_high_corr.RData")
rowMeans(RESULTS)
library(dplyr)
# aus eviews gruppe "alle_prognosen" -> markieren und copy (Strg + C)
dat <- read.table("clipboard", header = FALSE) %>% setNames(c("Date", "Anzeigen Konj-KUG saisonbereinigt","Konj-KUG saisonbereinigt", "Konjunktur-KUG", "Transfer-KUG",	"Saison-KUG",	"Zusammen"))
dat
install.packages("~/testpakete/fUCpack_0.1.tar.gz", repos = NULL, type = "source")
# Simulation:
# Performance of fUC for parameter estimation
#   - High and normal signal to noise ratios
#   - AR plus non-AR
#   - compare d with other nonparametric estimators
gc()
rm(list = ls())
library(fUCpack)
library(dplyr)
library(parallel)
# Wd, etc
setwd("~/Dokumente/Projekte/filtering unknown persistence/R/code")
# Settings
n <- c(100, 200, 300)
d <- c(0.75, 1, 1.25, 1.75)
r <- c(1, 5, 10)
R <- 1000
# Strong persistence
ar <- c(-1.6, 0.8)
# Weaker persistemce
#ar <- c(-0.9, 0.4)
# define grid
d.grid <- seq(0.75, 1.75, 0.25)
sig1.grid <- c(-0.5, -0.78, -0.86)
sig2.grid <- c(-0.5, 1.37, 2.15)
sig12.grid <- c(-1.10, -0.96, -0.85)
ar.1.grid <- c(-1.8, -1.7, -1.6, -1.5, -1.4)
ar2.grid  <- c(0.6, 0.7, 0.8, 0.9, 1)
gr.start <- expand.grid(d.grid, sig1.grid, sig12.grid, sig2.grid, ar.1.grid, ar2.grid) %>% as.matrix()
gr.start <- gr.start[sapply(1:nrow(gr.start), function(i) toComp(-c(gr.start[i, 5:6]))$stable) ,]
setups <- expand.grid(n, d, r)
colnames(setups) <- c("n", "d", "r")
setups <- setups[order(setups[, "n"]), ]
i=1
setup <- setups[ i, ]
n <- as.numeric(setup[1])
nu <- as.numeric(setup[3])
d <- as.numeric(setup[2])
cat("Iteration ", i, "\n")
set.seed(42)
# Generate the data
Q   <- matrix(c(1, -0.8*sqrt(nu), -0.8*sqrt(nu), nu), 2, 2)
ETA <- EPS <- matrix(NA, nrow = n, ncol=R)
for(j in 1:R){
ERR <-   mvtnorm::rmvnorm(n, mean=c(0, 0), sigma = Q)
ETA[, j] <- ERR[,1]
EPS[, j] <- ERR[,2]
}
x <- frac_diff_multi(ETA, -d)
c <- apply(EPS, 2, function(x) stats::filter(c(rep(0, length(ar)), x), filter = c(-ar), method = "recursive", sides = 1)[-(1:length(ar))])
y <- yy<-x + c
optfn <- function(n, y, x){
tryCatch({
# Estimate
# check grid
grid.st <- cbind(gr.start, sapply(1:nrow(gr.start), function(i) fUC_opt_ML(gr.start[i, ], corr=TRUE,
y=y, START = 1,
nulim = c(1/100, 25), nu.opt=F,
deterministics = FALSE)))
par0 <- grid.st[which.min(grid.st[,7]),-7]
(est <- optim(par=par0, control = list(), corr=TRUE,
fn = fUC_opt_ML, quiet = TRUE, START = 1, nu.opt=F,
y=y, method = "BFGS", nulim = c(1/100, 25), d.int = c(0.5, 2.5),
deterministics = FALSE))
# check for corner solutions: d->0, d->2, nu->1/100, nu->100
j=1
while(est$par[1] < .05 | est$par[1] > 1.95){
if(j > 10) break
j=j+1
par0 <- grid.st[order(grid.st[,6]),-6][j , ]
(est <- optim(par=par0, corr=TRUE,
fn = fUC_opt_ML, quiet = TRUE, d.int = c(0.5, 2.5),
y=y, method = "BFGS", nulim = c(1/100, 25),
deterministics = FALSE, START =1, nu.opt=F))
}
par <- est$par
Q <- mlogvech2mat(est$par[2:4])
ar <- est$par[-(1:4)]
#KF <- fUC_comp(y, par[1], nu, ar)
#KF2 <- fUC_comp((1:length(y))^par[1], par[1], nu, ar)
#mu  <- summary(lm(KF$v ~ -1 + KF2$v))$coefficients[1,1]
#Q <- matrix(c(1, corr, corr, nu), 2, 2)
KS <- fUC_smooth(y, par[1], Q, ar = ar, corr = TRUE)
Rsq <- summary(lm(x ~ KS$x))$r.squared
# Return results
results <- c(est$value, est$par, Rsq)
names(results) <- c("ll", "d", "Q11", "Q21", "Q22", "ar_1", "ar_2", "Rsq")
return(results)
}, error = function(e) return(rep(NA, 8))
)
}
optfn(n, y[,1], x[,1])
### fUC part
cl <- makeCluster(7)
clusterExport(cl, c("optfn", "fUC_opt_ML", "y", "fUC_comp", "ma_inf",
"embed0", "fUC_smooth", "x", "frac_diff", "lm", "n", "gr.start"))
clusterEvalQ(cl, library(fUCpack))
RESULTS <- parSapply(cl, 1:R, function(j) optfn(n, y[, j], x[, j]))
stopCluster(cl)
dEW_45 <- c(apply(y, 2, EW, type = 1, interval = c(0, 2.5), alpha = .45))
dEW_50 <- c(apply(y, 2, EW, type = 1, interval = c(0, 2.5), alpha = .50))
dEW_55 <- c(apply(y, 2, EW, type = 1, interval = c(0, 2.5), alpha = .55))
dEW_60 <- c(apply(y, 2, EW, type = 1, interval = c(0, 2.5), alpha = .60))
dEW_65 <- c(apply(y, 2, EW, type = 1, interval = c(0, 2.5), alpha = .65))
dEW_70 <- c(apply(y, 2, EW, type = 1, interval = c(0, 2.5), alpha = .70))
RESULTS <- rbind(RESULTS, c(dEW_45), c(dEW_50), c(dEW_55), c(dEW_60), c(dEW_65), c(dEW_70))
rownames(RESULTS) <- c("ll", "d", "Q11", "Q21", "Q22", "ar_1", "ar_2", "Rsq",
"d_45", "d_50", "d_55", "d_60", "d_65", "d_70")
stopCluster(cl)
